<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ê²½ê¸°ë„ ì¥ì• ì¸ì½œ ëŒ€ê¸°í˜„í™©</title>

<style>
body{margin:0;background:#111;color:#fff;font-family:Arial}
header{text-align:center;font-size:26px;padding:10px}
button{display:block;margin:10px auto;padding:8px 20px;font-size:18px}
.container{display:flex;width:100%;gap:4px;padding:4px}
.column{width:50%}
table{width:100%;border-collapse:collapse;font-size:18px}
th,td{border:1px solid #444;padding:4px;text-align:center}
th{background:#222}
#status{text-align:center;color:#ff6b6b;margin:5px}
</style>
</head>

<body>

<header>ê²½ê¸°ë„ ì¥ì• ì¸ì½œ ëŒ€ê¸°í˜„í™©</header>
<button onclick="loadData()">ğŸ” ìƒˆë¡œê³ ì¹¨</button>
<div id="status"></div>
<div id="time" style="text-align:center;"></div>

<div class="container">
<div class="column">
<table>
<thead><tr><th>ì‹œêµ°ëª…</th><th>ìš´í–‰</th><th>ëŒ€ê¸°</th></tr></thead>
<tbody id="left"></tbody>
</table>
</div>

<div class="column">
<table>
<thead><tr><th>ì‹œêµ°ëª…</th><th>ìš´í–‰</th><th>ëŒ€ê¸°</th></tr></thead>
<tbody id="right"></tbody>
</table>
</div>
</div>

<script>

const PRIORITY=[
"ì˜ì •ë¶€ì‹œ","ì–‘ì£¼ì‹œ","ë™ë‘ì²œì‹œ","í¬ì²œì‹œ",
"ë‚¨ì–‘ì£¼ì‹œ","ì—°ì²œêµ°","ê³ ì–‘ì‹œ","íŒŒì£¼ì‹œ"
];

async function loadData(){
document.getElementById("status").innerText="ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...";

try{
const res=await fetch(
"https://ggsts.gg.go.kr/receipt/getTotalWaitInfo.json",
{
method:"POST",
headers:{
"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"
},
body:"TR=GA11130"
});

const data=await res.json();

if(data.RESCODE!=="0000"){
throw new Error("ì‘ë‹µ ì˜¤ë¥˜");
}

let list=data.RESULT.LIST;

const fixed=list
.filter(x=>PRIORITY.includes(x.LNAME))
.sort((a,b)=>PRIORITY.indexOf(a.LNAME)-PRIORITY.indexOf(b.LNAME));

const others=list
.filter(x=>!PRIORITY.includes(x.LNAME))
.sort((a,b)=>a.LNAME.localeCompare(b.LNAME,"ko"));

const final=[...fixed,...others];

const mid=Math.ceil(final.length/2);

document.getElementById("left").innerHTML=
final.slice(0,mid).map(r=>
`<tr><td>${r.LNAME}</td><td>${r.CUR_VEHICLE}</td><td>${r.NUM_WAIT}</td></tr>`
).join("");

document.getElementById("right").innerHTML=
final.slice(mid).map(r=>
`<tr><td>${r.LNAME}</td><td>${r.CUR_VEHICLE}</td><td>${r.NUM_WAIT}</td></tr>`
).join("");

document.getElementById("status").innerText="";
document.getElementById("time").innerText=
"ì¡°íšŒ ì‹œê°: "+new Date().toLocaleString("ko-KR");

}catch(e){
document.getElementById("status").innerText="ë°ì´í„° ë¡œë”© ì‹¤íŒ¨";
}
}

loadData();
</script>

</body>
</html>
